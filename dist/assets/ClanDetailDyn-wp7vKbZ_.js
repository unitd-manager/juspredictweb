import{r as x,t as v,j as e,D as E,h as P,i as L,k as T,l as q,I as C,n as A,B as g,o as k,y as S,z as _,g as J,s as W,E as X,q as b,U as z,F as Z,v as f,G as ee,T as se,H as te,J as H,K as w,M as ae,N as y,O as ie,x as V,X as ne,Q as re,V as le,W as ce,Y as de}from"./index-PqdYZHXd.js";import{u as U,h as N,i as D,j as oe}from"./groupDyn-CtqiiWXe.js";function xe({groupId:s,groupName:d,trigger:m,onInvited:r}){const[l,o]=x.useState(!1),[n,h]=x.useState(""),[a,c]=x.useState(""),u=localStorage.getItem("userId")||"",{mutateAsync:j,isPending:p}=U({mutationFn:()=>N.inviteMembers({groupId:s,groupName:d,inviterUserId:u,invites:[{inviteeEmail:n,inviteeName:a,eventType:1}]}),onSuccess:()=>{v.success("Invitation sent"),o(!1),h(""),c(""),r==null||r()},onError:i=>{v.error((i==null?void 0:i.message)??"Failed to send invitation")}}),I=async i=>{i.preventDefault(),await j()};return e.jsxs(E,{open:l,onOpenChange:i=>!p&&o(i),children:[e.jsx(P,{asChild:!0,children:m}),e.jsx(L,{className:"sm:max-w-sm",children:e.jsxs("form",{onSubmit:I,className:"space-y-4",children:[e.jsx(T,{children:e.jsx(q,{children:"Invite a member"})}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm",children:"Member Email"}),e.jsx(C,{value:n,onChange:i=>h(i.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm",children:"Name (optional)"}),e.jsx(C,{value:a,onChange:i=>c(i.target.value)})]}),e.jsx(A,{children:e.jsxs(g,{type:"submit",disabled:p,children:[p&&e.jsx("span",{className:"mr-2 animate-spin",children:"⏳"}),"Send Invite"]})})]})})]})}const me=({groupId:s,trigger:d})=>{const[m,r]=x.useState(!1),[l,o]=x.useState(""),[n,h]=x.useState(!1),a=async c=>{if(c.preventDefault(),!l.trim()){S.error("Please enter an email address");return}h(!0);try{await new Promise(u=>setTimeout(u,300)),S.success("Invitation cancelled"),o(""),r(!1)}catch(u){S.error(u.message||"Failed to cancel invitation")}finally{h(!1)}};return e.jsxs(E,{open:m,onOpenChange:c=>!n&&r(c),children:[e.jsx(P,{onClick:()=>r(!0),children:d||e.jsx(g,{variant:"outline",children:"Cancel invites"})}),e.jsx(L,{children:e.jsxs("form",{onSubmit:a,className:"space-y-4",children:[e.jsx(T,{children:e.jsx(q,{children:"Cancel invitation"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-text",children:"Email address"}),e.jsx(C,{type:"email",value:l,onChange:c=>o(c.target.value),placeholder:"Enter email to cancel",required:!0}),e.jsx("p",{className:"text-xs text-gray-muted",children:"Enter the email address of the pending invitation to cancel"})]}),e.jsxs(A,{children:[e.jsx(g,{type:"button",variant:"outline",onClick:()=>r(!1),disabled:n,children:"Cancel"}),e.jsxs(g,{type:"submit",disabled:n,children:[n?e.jsx(k,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Cancel Invite"]})]})]})})]})},Y=s=>{if(!s)return"-";const d=new Date(s);return Number.isNaN(d.getTime())?s:oe(d,"MMM dd, yyyy • hh:mm a")},M=s=>`${(s==null?void 0:s.firstName)??""} ${(s==null?void 0:s.lastName)??""}`.trim()||(s==null?void 0:s.userName)||"Unknown user",he=s=>(s==null?void 0:s.replace("GROUPUSERROLE_","").replace(/_/g," "))??"MEMBER",ue=({activity:s})=>e.jsx("div",{className:"rounded-2xl border border-white/5 bg-white/5 p-4",children:e.jsxs("div",{className:"flex flex-col gap-1 text-sm text-white/80",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs uppercase tracking-wide text-muted-foreground",children:[e.jsx("span",{children:s.eventShortName??s.eventName??"Activity"}),e.jsx("span",{children:Y(s.eventStartDate)})]}),e.jsx("p",{className:"text-base font-semibold text-white",children:s.eventName??s.eventDescription}),s.eventLocation&&e.jsxs("p",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(ce,{className:"h-3 w-3"}),s.eventLocation]}),e.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[e.jsx(V,{variant:s.didIPredict?"default":"outline",className:"bg-emerald-500/20",children:s.didIPredict?"Predicted":"Spectating"}),s.didIPredict&&e.jsx(de,{className:"h-4 w-4 text-emerald-300"})]})]})}),ge=({groupId:s})=>{const[d,m]=x.useState(!1),[r,l]=x.useState(""),{mutateAsync:o,isPending:n}=U({mutationFn:async()=>{if(!r.trim())throw new Error("User ID is required");return N.leaveGroup({groupId:s,userId:r})},onSuccess:()=>{v.success("Leave request submitted"),m(!1),l("")},onError:a=>v.error(a.message||"Unable to leave clan")}),h=async a=>{a.preventDefault(),await o()};return e.jsxs(E,{open:d,onOpenChange:a=>!n&&m(a),children:[e.jsx(P,{asChild:!0,children:e.jsx(g,{variant:"outline",children:"Leave clan"})}),e.jsx(L,{className:"sm:max-w-sm",children:e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[e.jsx(T,{children:e.jsx(q,{children:"Leave this clan"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-foreground",children:"Your user ID"}),e.jsx(C,{value:r,onChange:a=>l(a.target.value),required:!0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Supply the user ID that matches your account. You can retrieve it from the profile API."})]}),e.jsx(A,{children:e.jsxs(g,{type:"submit",variant:"outline",disabled:n,children:[n?e.jsx(k,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Confirm leave"]})})]})})]})},Ne=()=>{var F,O,R,B,Q,G;const{groupId:s}=_(),d=J(),[m,r]=x.useState(null),l=D({queryKey:["group-info",s],queryFn:()=>s?N.getGroupInfo(s):Promise.reject(new Error("Missing group ID")),enabled:!!s}),o=D({queryKey:["group-activity",s],queryFn:()=>N.getGroupActivity(s),enabled:!!s}),n=D({queryKey:["group-leaderboard",s],queryFn:()=>N.getGroupLeaderboard(s),enabled:!!s}),h=U({mutationFn:t=>N.removeUsers({groupId:s,userId:[t]}),onMutate:t=>r(t),onSuccess:()=>{v.success("Member removed"),d.invalidateQueries({queryKey:["group-info",s]})},onError:t=>v.error(t.message||"Failed to remove member"),onSettled:()=>r(null)}),a=(F=l.data)==null?void 0:F.groupInfo,c=((O=l.data)==null?void 0:O.members)??[],u=((R=o.data)==null?void 0:R.activities)??[],j=x.useMemo(()=>{var t;return((t=n.data)==null?void 0:t.groupUserInfo)??[]},[(B=n.data)==null?void 0:B.groupUserInfo]),p=((Q=l.data)==null?void 0:Q.memberCount)??c.length,I=l.isPending||o.isPending||n.isPending,i=x.useMemo(()=>j[0],[j]);return s?e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-[#050505] via-[#081011] to-[#040706] text-white",children:e.jsxs("main",{className:"container mx-auto max-w-6xl px-4 py-10 space-y-8",children:[e.jsxs(W,{to:"/clan",className:"inline-flex items-center gap-2 text-sm text-muted-foreground hover:text-white",children:[e.jsx(X,{className:"h-4 w-4"}),"Back to clans"]}),e.jsx("section",{className:"rounded-3xl border border-white/10 bg-gradient-to-br from-emerald-500/10 to-transparent p-6",children:I?e.jsx(b,{className:"h-32 rounded-2xl bg-white/10"}):e.jsxs("div",{className:"flex flex-col gap-6 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm uppercase tracking-[0.5em] text-emerald-300/80",children:"Clan"}),e.jsx("h1",{className:"mt-2 text-3xl font-bold",children:(a==null?void 0:a.groupName)??"Unnamed clan"}),e.jsx("p",{className:"mt-1 text-sm text-white/60",children:a==null?void 0:a.groupAlias}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-3 text-sm text-white/80",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(z,{className:"h-4 w-4"}),p," members"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Z,{className:"h-4 w-4"}),(a==null?void 0:a.groupMode)??"PRIVATE"]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx(xe,{groupId:s,groupName:(a==null?void 0:a.groupName)??"",trigger:e.jsx(g,{className:"bg-emerald-500 text-white hover:bg-emerald-400",children:"Invite members"}),onInvited:()=>d.invalidateQueries({queryKey:["group-info",s]})}),e.jsx(me,{groupId:s,trigger:e.jsx(g,{variant:"outline",className:"border-white/30 text-white hover:bg-white/10",children:"Cancel invites"})}),e.jsx(ge,{groupId:s})]})]})}),e.jsxs("section",{className:"grid gap-6 lg:grid-cols-[2fr,1fr]",children:[e.jsxs(f,{className:"rounded-3xl border-white/10 bg-white/5 overflow-hidden relative",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-[#00ff73]/30 rounded-full -mr-16 -mt-16 pointer-events-none blur-lg"}),e.jsxs("div",{className:"p-6 relative z-10",children:[e.jsxs("h2",{className:"flex items-center gap-2 text-xl font-bold text-white mb-6",children:[e.jsx(ee,{className:"h-5 w-5 text-primary"}),"Live leaderboard"]}),n.isPending?e.jsx(b,{className:"h-48 rounded-2xl bg-white/10"}):j.length?e.jsxs(se,{children:[e.jsx(te,{children:e.jsxs(H,{className:"border-white/5 text-xs uppercase tracking-wide",children:[e.jsx(w,{className:"text-white",children:"Member"}),e.jsx(w,{className:"text-right text-white",children:"Accuracy"}),e.jsx(w,{className:"text-right text-white",children:"Earnings"}),e.jsx(w,{className:"text-right text-white",children:"Predictions"})]})}),e.jsx(ae,{children:j.map((t,$)=>{var K;return e.jsxs(H,{className:"border-white/5",children:[e.jsx(y,{className:"flex flex-col",children:e.jsx("span",{className:"font-semibold text-white",children:M(t.userInfo)})}),e.jsx(y,{className:"text-right text-white/80",children:t.accuracy??"-"}),e.jsx(y,{className:"text-right text-emerald-300",children:Number(t.earnings).toFixed(2)??"-"}),e.jsx(y,{className:"text-right text-white/80",children:t.predictions??0})]},((K=t.userInfo)==null?void 0:K.userId)??$)})})]}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No leaderboard data yet."})]})]}),e.jsxs(f,{className:"rounded-3xl border-white/10 bg-white/5 overflow-hidden relative",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-[#00ff73]/30 rounded-full -mr-16 -mt-16 pointer-events-none blur-lg"}),e.jsxs("div",{className:"p-6 relative z-10",children:[e.jsxs("h2",{className:"flex items-center gap-2 text-xl font-bold text-white mb-6",children:[e.jsx(z,{className:"h-5 w-5 text-primary"}),"Members"]}),l.isPending?e.jsx(b,{className:"h-64 rounded-2xl bg-white/10"}):e.jsx(ie,{className:"max-h-72 pr-4",children:e.jsxs("div",{className:"space-y-3",children:[c.map(t=>e.jsxs("div",{className:"flex items-center justify-between rounded-2xl border border-white/5 bg-white/5 p-3",children:[e.jsx("div",{children:e.jsx("p",{className:"text-sm font-semibold text-white",children:M(t)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{variant:"outline",className:"border-white/30 text-white",children:he(t.userRole)}),e.jsx("button",{className:"text-red-400 hover:text-red-300 disabled:opacity-50",disabled:!t.userId||m===t.userId,onClick:()=>t.userId&&h.mutate(t.userId),children:m===t.userId?e.jsx(k,{className:"h-4 w-4 animate-spin"}):e.jsx(ne,{className:"h-4 w-4"})})]})]},t.userId??t.userEmail??t.userName)),!c.length&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"No members yet."})]})})]})]})]}),e.jsxs("section",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(f,{className:"rounded-3xl border-white/10 bg-white/5 overflow-hidden relative",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-[#00ff73]/30 rounded-full -mr-16 -mt-16 pointer-events-none blur-lg"}),e.jsxs("div",{className:"p-6 relative z-10",children:[e.jsxs("h2",{className:"flex items-center gap-2 text-xl font-bold text-white mb-6",children:[e.jsx(re,{className:"h-5 w-5 text-primary"}),"Latest activity"]}),o.isPending?e.jsx(b,{className:"h-48 rounded-2xl bg-white/10"}):u.length?e.jsx("div",{className:"space-y-4",children:u.slice(0,4).map(t=>e.jsx(ue,{activity:t},t.entityId??t.eventName))}):e.jsx("p",{className:"text-sm text-gray-muted",children:"No activity yet."})]})]}),e.jsxs(f,{className:"rounded-3xl border-white/10 bg-white/5 overflow-hidden relative",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-[#00ff73]/30 rounded-full -mr-16 -mt-16 pointer-events-none blur-lg"}),e.jsxs("div",{className:"p-6 relative z-10",children:[e.jsxs("h2",{className:"flex items-center gap-2 text-xl font-bold text-white mb-6",children:[e.jsx(le,{className:"h-5 w-5 text-primary"}),"Highlights"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-2xl border border-white/5 bg-white/5 p-4",children:[e.jsx("p",{className:"text-sm text-white/70",children:"Current MVP"}),e.jsx("p",{className:"text-2xl font-semibold text-white",children:M(i==null?void 0:i.userInfo)}),e.jsxs("p",{className:"text-sm text-gray-muted",children:["Accuracy ",(i==null?void 0:i.accuracy)??"-"," • Earnings ",(i==null?void 0:i.earnings)??"-"]})]}),e.jsxs("div",{className:"rounded-2xl border border-white/5 bg-white/5 p-4",children:[e.jsx("p",{className:"text-sm text-white/70",children:"Members"}),e.jsx("p",{className:"text-2xl font-semibold text-white",children:p}),e.jsx("p",{className:"text-sm text-gray-muted",children:"Active participants in this clan"})]}),e.jsxs("div",{className:"rounded-2xl border border-white/5 bg-white/5 p-4",children:[e.jsx("p",{className:"text-sm text-white/70",children:"Last activity"}),e.jsx("p",{className:"text-lg text-white",children:Y((G=u[0])==null?void 0:G.eventStartDate)})]})]})]})]})]})]})}):e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-black text-white",children:e.jsx("p",{children:"Clan not found."})})};export{Ne as default};
