import{r as h,j as e,D as E,o as D,B as u,p as M,q as P,s as L,v as T,w as C,J as p,I as G,K as X,n as J,A as W,M as Z,z as f,U as z,N as ee,E as b,O as se,T as te,Q as ae,V as K,W as v,X as re,Y as w,Z as ne,H,_ as ie,$ as le,a0 as ce,x as y,a1 as de,a2 as oe}from"./index-CcWf4WKq.js";import{i as I,u as $,h as N,j as xe}from"./groupDyn-C0Wm1Pvx.js";const me=({groupName:s,trigger:c,onInvited:d})=>{const[i,r]=h.useState(!1),[o,n]=h.useState(""),[x,a]=h.useState(!1),m=async l=>{if(l.preventDefault(),!o.trim()){p.error("Please enter at least one email");return}a(!0);try{await new Promise(j=>setTimeout(j,500)),p.success("Invitations sent successfully"),n(""),r(!1),d==null||d()}catch(j){p.error(j.message||"Failed to send invitations")}finally{a(!1)}};return e.jsxs(E,{open:i,onOpenChange:l=>!x&&r(l),children:[e.jsx(D,{onClick:()=>r(!0),children:c||e.jsx(u,{children:"Invite members"})}),e.jsx(M,{children:e.jsxs("form",{onSubmit:m,className:"space-y-4",children:[e.jsx(P,{children:e.jsxs(L,{children:["Invite members to ",s||"clan"]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-text",children:"Email addresses"}),e.jsx("textarea",{value:o,onChange:l=>n(l.target.value),placeholder:"Enter email addresses (one per line)",className:"w-full bg-dark-bg border border-white/10 rounded-lg px-4 py-2.5 text-white placeholder:text-gray-muted focus:outline-none focus:border-primary/30 focus:ring-1 focus:ring-primary/20 transition-all resize-none h-32",required:!0}),e.jsx("p",{className:"text-xs text-gray-muted",children:"Enter email addresses separated by new lines"})]}),e.jsxs(T,{children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>r(!1),disabled:x,children:"Cancel"}),e.jsxs(u,{type:"submit",disabled:x,children:[x?e.jsx(C,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Send Invites"]})]})]})})]})},he=({groupId:s,trigger:c})=>{const[d,i]=h.useState(!1),[r,o]=h.useState(""),[n,x]=h.useState(!1),a=async m=>{if(m.preventDefault(),!r.trim()){p.error("Please enter an email address");return}x(!0);try{await new Promise(l=>setTimeout(l,300)),p.success("Invitation cancelled"),o(""),i(!1)}catch(l){p.error(l.message||"Failed to cancel invitation")}finally{x(!1)}};return e.jsxs(E,{open:d,onOpenChange:m=>!n&&i(m),children:[e.jsx(D,{onClick:()=>i(!0),children:c||e.jsx(u,{variant:"outline",children:"Cancel invites"})}),e.jsx(M,{children:e.jsxs("form",{onSubmit:a,className:"space-y-4",children:[e.jsx(P,{children:e.jsx(L,{children:"Cancel invitation"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-text",children:"Email address"}),e.jsx(G,{type:"email",value:r,onChange:m=>o(m.target.value),placeholder:"Enter email to cancel",required:!0}),e.jsx("p",{className:"text-xs text-gray-muted",children:"Enter the email address of the pending invitation to cancel"})]}),e.jsxs(T,{children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>i(!1),disabled:n,children:"Cancel"}),e.jsxs(u,{type:"submit",disabled:n,children:[n?e.jsx(C,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Cancel Invite"]})]})]})})]})},V=s=>{if(!s)return"-";const c=new Date(s);return Number.isNaN(c.getTime())?s:xe(c,"MMM dd, yyyy • hh:mm a")},S=s=>`${(s==null?void 0:s.firstName)??""} ${(s==null?void 0:s.lastName)??""}`.trim()||(s==null?void 0:s.userName)||"Unknown user",ue=s=>(s==null?void 0:s.replace("GROUPUSERROLE_","").replace(/_/g," "))??"MEMBER",ge=({activity:s})=>e.jsx("div",{className:"rounded-2xl border border-white/5 bg-white/5 p-4",children:e.jsxs("div",{className:"flex flex-col gap-1 text-sm text-white/80",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs uppercase tracking-wide text-muted-foreground",children:[e.jsx("span",{children:s.eventShortName??s.eventName??"Activity"}),e.jsx("span",{children:V(s.eventStartDate)})]}),e.jsx("p",{className:"text-base font-semibold text-white",children:s.eventName??s.eventDescription}),s.eventLocation&&e.jsxs("p",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(de,{className:"h-3 w-3"}),s.eventLocation]}),e.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[e.jsx(H,{variant:s.didIPredict?"default":"outline",className:"bg-emerald-500/20",children:s.didIPredict?"Predicted":"Spectating"}),s.didIPredict&&e.jsx(oe,{className:"h-4 w-4 text-emerald-300"})]})]})}),je=({groupId:s})=>{const[c,d]=h.useState(!1),[i,r]=h.useState(""),{mutateAsync:o,isPending:n}=$({mutationFn:async()=>{if(!i.trim())throw new Error("User ID is required");return N.leaveGroup({groupId:s,userId:i})},onSuccess:()=>{y.success("Leave request submitted"),d(!1),r("")},onError:a=>y.error(a.message||"Unable to leave clan")}),x=async a=>{a.preventDefault(),await o()};return e.jsxs(E,{open:c,onOpenChange:a=>!n&&d(a),children:[e.jsx(D,{asChild:!0,children:e.jsx(u,{variant:"outline",children:"Leave clan"})}),e.jsx(M,{className:"sm:max-w-sm",children:e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsx(P,{children:e.jsx(L,{children:"Leave this clan"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-foreground",children:"Your user ID"}),e.jsx(G,{value:i,onChange:a=>r(a.target.value),required:!0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Supply the user ID that matches your account. You can retrieve it from the profile API."})]}),e.jsx(T,{children:e.jsxs(u,{type:"submit",variant:"outline",disabled:n,children:[n?e.jsx(C,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Confirm leave"]})})]})})]})},fe=()=>{var q,A,U,O,R,B;const{groupId:s}=X(),c=J(),[d,i]=h.useState(null),r=I({queryKey:["group-info",s],queryFn:()=>s?N.getGroupInfo(s):Promise.reject(new Error("Missing group ID")),enabled:!!s}),o=I({queryKey:["group-activity",s],queryFn:()=>N.getGroupActivity(s),enabled:!!s}),n=I({queryKey:["group-leaderboard",s],queryFn:()=>N.getGroupLeaderboard(s),enabled:!!s}),x=$({mutationFn:t=>N.removeUsers({groupId:s,userId:[t]}),onMutate:t=>i(t),onSuccess:()=>{y.success("Member removed"),c.invalidateQueries({queryKey:["group-info",s]})},onError:t=>y.error(t.message||"Failed to remove member"),onSettled:()=>i(null)}),a=(q=r.data)==null?void 0:q.groupInfo,m=((A=r.data)==null?void 0:A.members)??[],l=((U=o.data)==null?void 0:U.activities)??[],j=h.useMemo(()=>{var t;return((t=n.data)==null?void 0:t.groupUserInfo)??[]},[(O=n.data)==null?void 0:O.groupUserInfo]),k=((R=r.data)==null?void 0:R.memberCount)??m.length,Y=r.isPending||o.isPending||n.isPending,g=h.useMemo(()=>j[0],[j]);return s?e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-[#050505] via-[#081011] to-[#040706] text-white",children:e.jsxs("main",{className:"container mx-auto max-w-6xl px-4 py-10 space-y-8",children:[e.jsxs(W,{to:"/clan",className:"inline-flex items-center gap-2 text-sm text-muted-foreground hover:text-white",children:[e.jsx(Z,{className:"h-4 w-4"}),"Back to clans"]}),e.jsx("section",{className:"rounded-3xl border border-white/10 bg-gradient-to-br from-emerald-500/10 to-transparent p-6",children:Y?e.jsx(f,{className:"h-32 rounded-2xl bg-white/10"}):e.jsxs("div",{className:"flex flex-col gap-6 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm uppercase tracking-[0.5em] text-emerald-300/80",children:"Clan"}),e.jsx("h1",{className:"mt-2 text-3xl font-bold",children:(a==null?void 0:a.groupName)??"Unnamed clan"}),e.jsx("p",{className:"mt-1 text-sm text-white/60",children:a==null?void 0:a.groupAlias}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-3 text-sm text-white/80",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(z,{className:"h-4 w-4"}),k," members"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ee,{className:"h-4 w-4"}),(a==null?void 0:a.groupMode)??"PRIVATE"]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx(me,{groupId:s,groupName:a==null?void 0:a.groupName,trigger:e.jsx(u,{className:"bg-emerald-500 text-white hover:bg-emerald-400",children:"Invite members"}),onInvited:()=>c.invalidateQueries({queryKey:["group-activity",s]})}),e.jsx(he,{groupId:s,trigger:e.jsx(u,{variant:"outline",className:"border-white/30 text-white hover:bg-white/10",children:"Cancel invites"})}),e.jsx(je,{groupId:s})]})]})}),e.jsxs("section",{className:"grid gap-6 lg:grid-cols-[2fr,1fr]",children:[e.jsxs(b,{className:"rounded-3xl border-white/10 bg-white/5 overflow-hidden relative",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-[#00ff73]/30 rounded-full -mr-16 -mt-16 pointer-events-none blur-lg"}),e.jsxs("div",{className:"p-6 relative z-10",children:[e.jsxs("h2",{className:"flex items-center gap-2 text-xl font-bold text-white mb-6",children:[e.jsx(se,{className:"h-5 w-5 text-primary"}),"Live leaderboard"]}),n.isPending?e.jsx(f,{className:"h-48 rounded-2xl bg-white/10"}):j.length?e.jsxs(te,{children:[e.jsx(ae,{children:e.jsxs(K,{className:"border-white/5 text-xs uppercase tracking-wide",children:[e.jsx(v,{className:"text-white",children:"Member"}),e.jsx(v,{className:"text-right text-white",children:"Accuracy"}),e.jsx(v,{className:"text-right text-white",children:"Earnings"}),e.jsx(v,{className:"text-right text-white",children:"Predictions"})]})}),e.jsx(re,{children:j.map((t,_)=>{var F,Q;return e.jsxs(K,{className:"border-white/5",children:[e.jsxs(w,{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-white",children:S(t.userInfo)}),e.jsx("span",{className:"text-xs text-muted-foreground",children:(F=t.userInfo)==null?void 0:F.userEmail})]}),e.jsx(w,{className:"text-right text-white/80",children:t.accuracy??"-"}),e.jsx(w,{className:"text-right text-emerald-300",children:t.earnings??"-"}),e.jsx(w,{className:"text-right text-white/80",children:t.predictions??0})]},((Q=t.userInfo)==null?void 0:Q.userId)??_)})})]}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No leaderboard data yet."})]})]}),e.jsxs(b,{className:"rounded-3xl border-white/10 bg-white/5 overflow-hidden relative",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-[#00ff73]/30 rounded-full -mr-16 -mt-16 pointer-events-none blur-lg"}),e.jsxs("div",{className:"p-6 relative z-10",children:[e.jsxs("h2",{className:"flex items-center gap-2 text-xl font-bold text-white mb-6",children:[e.jsx(z,{className:"h-5 w-5 text-primary"}),"Members"]}),r.isPending?e.jsx(f,{className:"h-64 rounded-2xl bg-white/10"}):e.jsx(ne,{className:"max-h-72 pr-4",children:e.jsxs("div",{className:"space-y-3",children:[m.map(t=>e.jsxs("div",{className:"flex items-center justify-between rounded-2xl border border-white/5 bg-white/5 p-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-white",children:S(t)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t.userEmail??t.userName})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(H,{variant:"outline",className:"border-white/30 text-white",children:ue(t.userRole)}),e.jsx("button",{className:"text-red-400 hover:text-red-300 disabled:opacity-50",disabled:!t.userId||d===t.userId,onClick:()=>t.userId&&x.mutate(t.userId),children:d===t.userId?e.jsx(C,{className:"h-4 w-4 animate-spin"}):e.jsx(ie,{className:"h-4 w-4"})})]})]},t.userId??t.userEmail??t.userName)),!m.length&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"No members yet."})]})})]})]})]}),e.jsxs("section",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(b,{className:"rounded-3xl border-white/10 bg-white/5 overflow-hidden relative",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-[#00ff73]/30 rounded-full -mr-16 -mt-16 pointer-events-none blur-lg"}),e.jsxs("div",{className:"p-6 relative z-10",children:[e.jsxs("h2",{className:"flex items-center gap-2 text-xl font-bold text-white mb-6",children:[e.jsx(le,{className:"h-5 w-5 text-primary"}),"Latest activity"]}),o.isPending?e.jsx(f,{className:"h-48 rounded-2xl bg-white/10"}):l.length?e.jsx("div",{className:"space-y-4",children:l.slice(0,4).map(t=>e.jsx(ge,{activity:t},t.entityId??t.eventName))}):e.jsx("p",{className:"text-sm text-gray-muted",children:"No activity yet."})]})]}),e.jsxs(b,{className:"rounded-3xl border-white/10 bg-white/5 overflow-hidden relative",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-[#00ff73]/30 rounded-full -mr-16 -mt-16 pointer-events-none blur-lg"}),e.jsxs("div",{className:"p-6 relative z-10",children:[e.jsxs("h2",{className:"flex items-center gap-2 text-xl font-bold text-white mb-6",children:[e.jsx(ce,{className:"h-5 w-5 text-primary"}),"Highlights"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-2xl border border-white/5 bg-white/5 p-4",children:[e.jsx("p",{className:"text-sm text-white/70",children:"Current MVP"}),e.jsx("p",{className:"text-2xl font-semibold text-white",children:S(g==null?void 0:g.userInfo)}),e.jsxs("p",{className:"text-sm text-gray-muted",children:["Accuracy ",(g==null?void 0:g.accuracy)??"-"," • Earnings ",(g==null?void 0:g.earnings)??"-"]})]}),e.jsxs("div",{className:"rounded-2xl border border-white/5 bg-white/5 p-4",children:[e.jsx("p",{className:"text-sm text-white/70",children:"Members"}),e.jsx("p",{className:"text-2xl font-semibold text-white",children:k}),e.jsx("p",{className:"text-sm text-gray-muted",children:"Active participants in this clan"})]}),e.jsxs("div",{className:"rounded-2xl border border-white/5 bg-white/5 p-4",children:[e.jsx("p",{className:"text-sm text-white/70",children:"Last activity"}),e.jsx("p",{className:"text-lg text-white",children:V((B=l[0])==null?void 0:B.eventStartDate)})]})]})]})]})]})]})}):e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-black text-white",children:e.jsx("p",{children:"Clan not found."})})};export{fe as default};
